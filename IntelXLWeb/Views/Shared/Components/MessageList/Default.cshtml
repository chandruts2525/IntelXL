@model List<IntelXLDataAccess.Models.Chat>;
@{
    var toUserId = ViewBag.ToUserId;
    var conversationId = Guid.NewGuid().ToString();
}
@if (Model != null && Model.Count > 0)
{
    @foreach (var item in Model)
    {
        conversationId = item.ConversationId ?? conversationId;
        <input type="hidden" id="ConvoId" value="@conversationId" />
        if (toUserId == item.FromId)
        {
            <div class="message-container">
                <div class="img-container" style="float: right;">
                    <div class="message darker" style="max-width: 280px;">
                        <p>@item.Message</p>
                        @if (!string.IsNullOrEmpty(item.MediaUrl))
                        {
                            <div>
                                <div class="d-flex justify-content-between me-3 border border-1 rounded-1 px-2" style="background-color:#fff">
                                    <a href="@item.MediaUrl" class=" text-decoration-none  d-flex justify-content-between align-items-center" target="_blank">
                                        <div class="text-muted"><i class="fa-solid fa-file"></i></div>
                                        <div class="p-1 text-black">
                                            <div class="document-name">@item.FileName</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                    <img src="~/images/child.png" alt="Avatar" class="avatar right">
                </div>
            </div>
        }
        else
        {
            <div class="message-container">
                <div class="img-container">
                    <img src="~/images/child.png" alt="Avatar" class="avatar me-2">
                    <div class="message ">
                        <p>@item.Message</p>
                        @if (!string.IsNullOrEmpty(item.MediaUrl))
                        {
                            <div>
                                <div class="d-flex justify-content-between me-3 border border-1 rounded-1 px-2" style="background-color:#fff">
                                    <a href="@item.MediaUrl" class=" text-decoration-none  d-flex justify-content-between align-items-center" target="_blank">
                                        <div class="text-muted"><i class="fa-solid fa-file"></i></div>
                                        <div class="p-1 text-black">
                                            <div class="document-name">@item.FileName</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    }      

}
else
{
    <input type="hidden" id="ConvoId" value="@conversationId" />
}
<div id="chatBox">
</div>
<div class="typing-indicator" style="display:none">
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
</div>
