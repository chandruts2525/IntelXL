@*@section Styles{
    <style>

        .clone-content {
            border: 1px solid #c5c5c5;
            min-width:450px;
            margin-bottom:15px;
            background-color: #fff;
        }
        .clone-item input {
            width: 20px;
            height: 20px;
        }

        .ix-clone-checkbox:checked {
            background-color: #008080;
            border-color: #008080;
        }

        .collapse-container{
            min-height: calc(100vh - 141.5px);
            background-color: #daeeff5c;
            padding: 42px;
        }
    </style>
}

<div class="container">
   <div class="container collapse-container">
        <div class="me-auto">
            <a href="#" onclick="history.go(-1);" style="color: #207bff; text-decoration: none;"><i class="fa-solid fa-arrow-left-long me-2"></i>Back</a>
        </div>
        <h2 class="text-center pt-3">Clone Questions</h2>
        <div class="d-flex justify-content-center align-items-center">
            <div class="collapse-content first-content">
                <div class="clone-content">
                    <div class="p-4 d-flex justify-content-between" role="button" data-bs-toggle="collapse" data-bs-target="#collapseCourse" aria-expanded="false" aria-controls="collapseCourse">
                        Course
                        <div class="accordion-icon"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    <div class="collapse pb-3" id="collapseCourse">
                        <div class="list-group ms-3">
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="tnpse" />
                                <label class="form-check-label ms-4" for="tnpse">TNPSE</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="tnusrb" />
                                <label class="form-check-label ms-4" for="tnusrb">TNUSRB</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="banking" />
                                <label class="form-check-label ms-4" for="banking">Bank Exam</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="ssc" />
                                <label class="form-check-label ms-4" for="ssc">SSC</label>
                            </div>
                            <!-- Add more sort items as needed -->
                        </div>
                    </div>
                </div>
                <div class="clone-content">
                    <div class="p-4 d-flex justify-content-between" role="button" data-bs-toggle="collapse" data-bs-target="#collapseClass" aria-expanded="false" aria-controls="collapseClass">
                        Class
                        <div class="accordion-icon"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    <div class="collapse pb-3" id="collapseClass">
                        <div class="list-group ms-3">
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="class10" />
                                <label class="form-check-label ms-4" for="class10">Class 10</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="class11" />
                                <label class="form-check-label ms-4" for="class11">Class 11</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="class12" />
                                <label class="form-check-label ms-4" for="class12">Class 12</label>
                            </div>
                            <!-- Add more sort items as needed -->
                        </div>
                    </div>
                </div>
                <div class="clone-content">
                    <div class="p-4 d-flex justify-content-between" role="button" data-bs-toggle="collapse" data-bs-target="#collapseSubject" aria-expanded="false" aria-controls="collapseSubject">
                        Subjects
                        <div class="accordion-icon"><i class="fas fa-chevron-down"></i></div>
                    </div>
                    <div class="collapse pb-3" id="collapseSubject">
                        <div class="list-group ms-3">
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="maths" />
                                <label class="form-check-label ms-4" for="maths">Maths</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="english" />
                                <label class="form-check-label ms-4" for="english">English</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="science" />
                                <label class="form-check-label ms-4" for="science">Science</label>
                            </div>
                            <div class="clone-item d-flex py-2 mt-2">
                                <input type="checkbox" class="form-check-input ix-clone-checkbox" name="cloneItem" id="tamil" />
                                <label class="form-check-label ms-4" for="tamil">Tamil</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="float-end"><button class="btn btn-success px-3">Clone Questions</button></div>
   </div>
    

</div>
*@
@model IntelXLDataAccess.Models.QuestionMaster;
@section Styles{
    <link href="~/css/style.css" rel="stylesheet" />
}

<div class="d-flex justify-content-center container-wrap">
    <div class="main-container">
        @*<div class="me-auto mt-3">
            <a href="#" style="color: #207bff; text-decoration: none;" onclick="goBackWithSelectedOptions()"><i class="fa-solid fa-arrow-left-long me-2"></i>Back</a>
        </div>*@
        <h1 class="main-heading mt-2 text-center text-secondary">Choose where to clone</h1>
        <div class="p-2 warning-msg text-center"></div>
        <div class="d-flex p-3" id="ix_language">

            <div class="d-flex mx-1 label"> <label class="form-label text-secondary"><b>Language:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary ix_language" required asp-items="ViewBag.languages">
                    <option selected disabled value="">Select language...</option>
                </select>
            </div>
           @* <div>
                <button type="button" class="add-btn px-2 mx-1 ix_addlanguage btn"><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="ix_editlanguage px-2 mx-1 btn"><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@
        </div>
        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"> <label class="form-label text-secondary"><b>Course:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="courses" required data-target="classes" disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
            @*<div>
                <button type="button" class="add-btn px-2 mx-1 otherCourse btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Course" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@
        </div>

        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"> <label for="courses" class="form-label text-secondary"><b>Class:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="classes" data-target="subjects" required disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
           @* <div>
                <button type="button" class="add-btn otherClass px-2 mx-1 btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Classes" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@

        </div>

        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"> <label class="form-label text-secondary"><b>Subject:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="subjects" data-target="units" required disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
            @*<div>
                <button type="button" class="add-btn otherSubject px-2 mx-1 btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Subjects" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@

        </div>

        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"><label class="form-label text-secondary"><b>Unit:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="units" data-target="topics" required disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
           @* <div>
                <button type="button" class="add-btn otherUnit px-2 mx-1 btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Units" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@
        </div>

        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"> <label class="form-label text-secondary"><b>Topic:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="topics" data-target="subtopics" required disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
            @*<div>
                <button type="button" class="add-btn otherTopic px-2 mx-1 btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Topics" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@
        </div>

        <div class="d-flex p-3" id="selectRow">

            <div class="d-flex mx-1 label"><label for="subtopic" class="form-label text-secondary"><b>Subtopic:</b></label></div>

            <div class="ms-5 me-2">
                <select class="form-select text-secondary" id="subtopics" required disabled>
                    <option selected disabled value="">Select here...</option>
                </select>
            </div>
           @* <div>
                <button type="button" class="add-btn otherSubtopic px-2 mx-1 btn" disabled><i class="fa-solid fa-plus fa-sm"></i>Add</button>
            </div>
            <div class="">
                <button type="button" class="getAll px-2 mx-1 btn" data-target="Subtopics" disabled><i class="fa-solid fa-pencil mx-1"></i>Edit</button>
            </div>*@

        </div>
        <div class="d-flex  justify-content-center my-5">
            <button type="button" class="btn clone-cancel-btn px-4 mx-3"><i class="fa-solid fa-ban"></i> Cancel</button>
            <button type="button" class="btn clone-btn px-4" disabled><i class="fa-regular fa-clone"></i>  Clone</button>
        </div>
    </div>
</div>
@section Scripts{
    <script src="~/js/questions.js"></script>
    <script>
        let question = @Html.Raw(Json.Serialize(Model));
        let currentSubTopicId = question.subTopicId;
        $(document).ready(function(){
            $("#subtopics").on("change", function () {
                if ($("#subtopics").val()) {
                    $(".clone-btn").prop('disabled', false)
                }
            });
            $(".getAll,.add-btn,.ix_editlanguage").remove();
            $(".clone-btn").on("click",function(){
                let new_subtopicId = $("#subtopics").val();
                if (!new_subtopicId){
                    //alert("Select the fields");
                    showtoast("info", "Select the fields");
                }
                else if (question.subTopic.topic.unit.subject.class.courseId == $("#courses").val()) {
                  alert("Can't clone to same course");
                }
                else {
                    question.subTopicId = new_subtopicId;
                    $.each(question.choiceMasters, function (index, item) {
                        item.questionId=0;
                        item.choiceId = 0;
                        console.log(item);
                    });
                    question.answer = null;
                    question.questionId = 0;
                    question.subTopic = null;
                    cloneQuestion(question,currentSubTopicId)
                }                
            });
            $(".clone-cancel-btn").on("click", function () {
                window.location.href = "/Question/AllQuestions?id=" + currentSubTopicId;
            });
        });
        function cloneQuestion(question, currentSubTopicId) {
            console.log(question)
            $.ajax({
                type: "POST",
                url: "/Question/AddQuestion",
                data: JSON.stringify(question),
                contentType: "application/json",
                success: function (data) {
                    if (data) {
                        window.location.href = "/Question/AllQuestions?id=" + currentSubTopicId;
                    }
                    else {
                        showtoast("error", "Something went wrong. Please try again");
                    }
                },
                error: function (error) {
                    showtoast("error", "Something went wrong. Please try again");
                }
            });
        }
    </script>
}